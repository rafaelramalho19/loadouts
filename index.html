<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raising Warzone Loadouts</title>
    <meta name="description" content="Loadout list for twitch.tv/raisingz">
    <meta name="og:image" content="https://i.imgur.com/mpVR7I9.jpg">
</head>
<link rel="stylesheet" href="style.css">

<body>
    <div class="titles">
        <h2>Cold War</h2>
        <h2>Modern Warfare</h2>
    </div>

    <div class="weapons">
        <div class="cold-war">
            <div class="weapon">
                <h3>FFAR</h3>
                <img src="https://snipboard.io/mIsoY2.jpg" alt="FFAR">
            </div>
            <div class="weapon">
                <h3>Diamatti</h3>
                <img src="https://snipboard.io/02jh3J.jpg" alt="Dimatti">
            </div>
            <div class="weapon">
                <h3>DMR</h3>
                <img src="https://snipboard.io/Se4nFv.jpg" alt="DMR">
            </div>
            <div class="weapon">
                <h3>MAC10</h3>
                <img src="https://snipboard.io/GWiIwr.jpg" alt="MAC10">
            </div>
        </div>

        <div class=warfare">
            <div class="weapon">
                <h3>Kar98</h3>
                <img src="https://snipboard.io/4sAw3Y.jpg" alt="Kar98">
            </div>
            <div class="weapon">
                <h3>Diamatti</h3>
                <img src="https://snipboard.io/02jh3J.jpg" alt="Dimatti">
            </div>
            <div class="weapon">
                <h3>DMR</h3>
                <img src="https://snipboard.io/Se4nFv.jpg" alt="DMR">
            </div>
            <div class="weapon">
                <h3>MAC10</h3>
                <img src="https://snipboard.io/GWiIwr.jpg" alt="MAC10">
            </div>
        </div>
    </div>

    <div id="overlay" hidden>
        <img src="" alt="">
        <button id="close-overlay">X</button>
    </div>
    <footer><a href="https://twitch.tv/raisingz">twitch.tv/raisingz</a></footer>


    <script>
        const overlayElement = document.querySelector('#overlay');
        const image = overlayElement.querySelector('img');

        const urlParams = new URLSearchParams(window.location.search);
        const activeWeapon = decodeURIComponent(urlParams.get('gun'));

        console.log(activeWeapon)

        if(activeWeapon !== 'null' && !!activeWeapon) {
            overlayElement.removeAttribute('hidden')
            const activeElement = Array.from(document.querySelectorAll('h3')).filter(x => x.textContent === activeWeapon)
            image.setAttribute('src', activeElement[0].parentNode.querySelector('img').src)
        }

        document.querySelectorAll('img').forEach(el => el.addEventListener('click', (ev) => {
            overlayElement.removeAttribute('hidden')
            image.setAttribute('src', ev.currentTarget.src)
            const weaponName = ev.currentTarget.parentNode.querySelector('h3').textContent
            window.history.pushState(null, null, `?gun=${encodeURIComponent(weaponName)}`)
        }));

        document.querySelector('#close-overlay').addEventListener('click', () => {
            overlayElement.setAttribute('hidden', true)
            window.history.replaceState({}, document.title, window.location.protocol + "//" + window.location.host + window.location.pathname);
        })
    </script>
</body>

</html>